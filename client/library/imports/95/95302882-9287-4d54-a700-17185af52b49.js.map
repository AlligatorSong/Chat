{"version":3,"sources":["assets\\Script\\Chat.js"],"names":["account","window","cc","Class","extends","Component","properties","scrollView","ScrollView","viewContent","Layout","chatItem","Prefab","returnBtn","Button","enterBtn","enterText","EditBox","showBtn","nameLab","Label","roomLab","onLoad","string","getUserName","getUserChannel","update","dt","replaceString","wordArray","arguments","split","word","index","length","element","createList","i","item","instantiate","label","getComponent","RichText","node","addChild","clickShowBtn","removeAllChildren","height","clickEnterBtn","undefined","console","log","now","Date","Format","maskSizeH","getChildByName","curContentHeight","stopAutoScroll","bolBottomToTop","VerticalDirection","BOTTOM_TO_TOP","verticalDirection","y","scrollToBottom","scrollToTop","clickReturnBtn","director","loadScene"],"mappings":"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","file":"unknown","sourcesContent":["var account = window.account\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        scrollView: cc.ScrollView,\n        viewContent:cc.Layout,\n        chatItem: cc.Prefab,\n        returnBtn: cc.Button,\n        enterBtn: cc.Button,\n        enterText: cc.EditBox,\n        showBtn: cc.Button,\n        nameLab: cc.Label,\n        roomLab: cc.Label,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        // this.createList()\n        this.nameLab.string = 'name:'+account.getUserName();\n        this.roomLab.string = 'room:'+account.getUserChannel();\n    },\n\n    // called every frame\n    update: function (dt) {\n    },\n    \n    // arguments[0]为要替换的目标string\n    // [1]时间、[2]from、[3]to、[4]content\n    replaceString: function(){\n        let wordArray = arguments[0].split('@');\n        let word = '';\n        for (let index = 0; index < wordArray.length-1; index++) {\n            const element = wordArray[index];\n            word = word + element + arguments[index+1];\n        }\n        return word;\n    },\n\n    createList: function() {\n        for (let i = 1; i < 21; ++i) {\n            let item = cc.instantiate(this.chatItem);\n            let label = item.getComponent(cc.RichText);\n            label.string = this.replaceString(label.string,'11--'+i,'A'+i,'B'+i);\n            this.viewContent.node.addChild(item);\n        }\n    },\n\n    //arguments[1]eventData\n    clickShowBtn: function () {\n        this.viewContent.node.removeAllChildren()\n        this.viewContent.node.height = 0\n    },\n\n    clickEnterBtn: function () {\n        if (this.enterText.string==undefined\n            || this.enterText.string==''\n            || this.enterText.string==null){\n                console.log('plase enter word---')\n            return\n        }\n        let item = cc.instantiate(this.chatItem);\n        let label = item.getComponent(cc.RichText);\n        let now = new Date();\n        label.string = this.replaceString(label.string,now.Format('yyyy-MM-dd hh:mm:ss')+'\\t','C','D',this.enterText.string);\n        this.enterText.string = ''\n        this.viewContent.node.addChild(item);\n        let maskSizeH = this.scrollView.node.getChildByName('view').height;\n        let curContentHeight = this.viewContent.node.height+item.height\n        if(maskSizeH>=curContentHeight){\n            return;\n        }\n        this.scrollView.stopAutoScroll()\n        let bolBottomToTop = cc.Layout.VerticalDirection.BOTTOM_TO_TOP==this.viewContent.verticalDirection;\n        if (!bolBottomToTop){\n            if (this.viewContent.node.y>=(this.viewContent.node.height-2*maskSizeH)/2){\n                this.scrollView.scrollToBottom()\n            }else{\n                this.viewContent.node.y -= item.height/2;\n            }\n        }else {\n            if (this.viewContent.node.y<=-(this.viewContent.node.height-2*maskSizeH)/2){\n                this.scrollView.scrollToTop()\n            }else{\n                this.viewContent.node.y += item.height/2;\n            }\n        }\n    },\n\n    clickReturnBtn: function () {\n        cc.director.loadScene('load');\n    },\n});\n"]}